<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>कृषि Sahayak: AI Crop Yield Prediction</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FIX: Replaced lucide script with deferred UMD version to fix loading errors -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script>
        // Tailwind dark mode config
        tailwind.config = {
            darkMode: 'class',
        }
    </script>

    <!-- Soil dataset -->
    <script src="soilData.js"></script>
    <script>
        // Fallback dataset if external file fails to load
        if (typeof window.districtSoilData === 'undefined' && typeof districtSoilData === 'undefined') {
            window.districtSoilData = {
                "Hisar": { "Zn": 38.64, "Fe": 31.7, "Cu": 90.22, "Mn": 35.12, "B": 73.1, "S": 89.2 },
                "Indore": { "Zn": 58.79, "Fe": 72.82, "Cu": 96.97, "Mn": 81.38, "B": 73.1, "S": 62.91 },
                "Karnal": { "Zn": 58.79, "Fe": 64.69, "Cu": 87.72, "Mn": 21.03, "B": 66.86, "S": 82.26 },
                "Nagpur": { "Zn": 43.1, "Fe": 45.41, "Cu": 99.41, "Mn": 96.06, "B": 69.93, "S": 51.24 },
                "Sirsa": { "Zn": 59.95, "Fe": 50.19, "Cu": 92.74, "Mn": 22.84, "B": 69.18, "S": 98.24 },
                "Aurangabad": { "Zn": 63.32, "Fe": 57.82, "Cu": 98.74, "Mn": 92.63, "B": 21.02, "S": 47.08 }
            };
        }
        // Ensure global variable reference exists for downstream code
        if (typeof districtSoilData === 'undefined' && typeof window.districtSoilData !== 'undefined') {
            var districtSoilData = window.districtSoilData;
        }
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
        /* Mobile Nav active state */
        .nav-item-mobile.active svg,
        .nav-item-mobile.active p {
            color: #2563eb;
        }
        /* Desktop Sidebar active state */
        .nav-item-desktop.active {
            background-color: #eef2ff; /* indigo-50 */
            color: #4338ca; /* indigo-700 */
            font-weight: 600;
        }
        .dark .nav-item-desktop.active {
            background-color: #312e81; /* indigo-900 */
            color: #a5b4fc; /* indigo-300 */
        }
        .nav-item-desktop.active svg {
             color: #4338ca; /* indigo-700 */
        }
        .dark .nav-item-desktop.active svg {
            color: #a5b4fc; /* indigo-300 */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 5px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .dark ::-webkit-scrollbar-track {
            background: #27272a;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .prediction-step {
            display: none;
        }
        .prediction-step.active {
            display: block;
        }
    </style>
</head>
<body class="antialiased text-gray-800 bg-gray-50 dark:bg-gray-900 dark:text-gray-200">
    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-2xl max-w-sm w-full text-center m-4">
            <h2 class="text-2xl font-bold text-green-800 dark:text-green-300 mb-2">Welcome to कृषि Sahayak</h2>
            <p class="text-gray-600 dark:text-gray-400 mb-6">Please log in to continue.</p>
            <div class="space-y-4">
                <input type="email" placeholder="Email or Phone" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                <input type="password" placeholder="Password / OTP" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                <button id="login-button" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors">
                    Citizen Login
                </button>
            </div>
             <p class="text-xs text-gray-400 mt-4">For demo purposes, other roles can be accessed by closing this modal.</p>
            <button id="close-modal-button" class="mt-4 text-sm text-gray-500 hover:text-gray-800 dark:hover:text-white">Continue as Guest &rarr;</button>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profile-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-blur-sm">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-2xl max-w-sm w-full m-4">
            <div class="flex items-center justify-between mb-2">
                <h2 class="text-xl font-bold text-gray-900 dark:text-white">Your Profile</h2>
                <button id="close-profile-button" class="p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div class="space-y-2 text-sm">
                <p><span class="font-semibold">Name:</span> <span id="profile-name">-</span></p>
                <p><span class="font-semibold">Email:</span> <span id="profile-email">-</span></p>
            </div>
            <div class="mt-4 text-right">
                <button id="close-profile-button-2" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200">Close</button>
            </div>
        </div>
    </div>

    <!-- Urgent Alert Banner -->
    <div id="urgent-alert" class="hidden fixed top-0 left-0 right-0 z-50 bg-red-600 text-white p-3 text-center flex justify-between items-center shadow-lg animate-fade-in-down">
        <div class="flex items-center justify-center flex-1">
            <i data-lucide="alert-triangle" class="w-5 h-5 mr-2"></i>
            <span id="alert-message">Urgent: Severe thunderstorm warning issued for your area.</span>
        </div>
        <button id="close-alert" class="p-1 rounded-full hover:bg-red-700">
            <i data-lucide="x" class="w-5 h-5"></i>
        </button>
    </div>

    <div id="app-wrapper" class="relative md:flex min-h-screen">
        
        <!-- Desktop Sidebar -->
        <aside class="hidden bg-white dark:bg-gray-800 md:flex flex-col w-20 lg:w-64 border-r dark:border-gray-700 shrink-0">
            <div class="px-4 py-6">
                <div class="flex items-center justify-center lg:justify-start space-x-3">
                     <img src="C:\Users\ASUS\Pictures\Picture1.png" alt="Logo" class="h-20 w-15 shrink-0 rounded-lg">
                     <span class="font-bold text-xl hidden lg:inline text-gray-800 dark:text-white"></span>
                </div>
            </div>
            <nav class="flex-1 px-2 lg:px-4 space-y-2">
                <button onclick="navigateToPage('dashboard-page')" class="nav-item nav-item-desktop w-full flex items-center space-x-3 p-3 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors justify-center lg:justify-start">
                    <i data-lucide="layout-dashboard" class="w-6 h-6 shrink-0"></i>
                    <span class="font-semibold hidden lg:inline">Dashboard</span>
                </button>
                 <button onclick="navigateToPage('prediction-page')" class="nav-item nav-item-desktop w-full flex items-center space-x-3 p-3 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors justify-center lg:justify-start">
                    <i data-lucide="brain-circuit" class="w-6 h-6 shrink-0"></i>
                    <span class="font-semibold hidden lg:inline">Crop Yield</span>
                </button>
                 <button onclick="navigateToPage('advisory-page')" class="nav-item nav-item-desktop w-full flex items-center space-x-3 p-3 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors justify-center lg:justify-start">
                    <i data-lucide="lightbulb" class="w-6 h-6 shrink-0"></i>
                    <span class="font-semibold hidden lg:inline">Smart Advisory</span>
                </button>
                <button onclick="navigateToPage('weather-page')" class="nav-item nav-item-desktop w-full flex items-center space-x-3 p-3 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors justify-center lg:justify-start">
                    <i data-lucide="cloud-sun" class="w-6 h-6 shrink-0"></i>
                    <span class="font-semibold hidden lg:inline">Weather</span>
                </button>
                 <button onclick="navigateToPage('mandi-page')" class="nav-item nav-item-desktop w-full flex items-center space-x-3 p-3 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors justify-center lg:justify-start">
                    <i data-lucide="bar-chart-3" class="w-6 h-6 shrink-0"></i>
                    <span class="font-semibold hidden lg:inline">Mandi Prices</span>
                </button>
                <button onclick="navigateToPage('community-page')" class="nav-item nav-item-desktop w-full flex items-center space-x-3 p-3 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors justify-center lg:justify-start">
                    <i data-lucide="users" class="w-6 h-6 shrink-0"></i>
                    <span class="font-semibold hidden lg:inline">Forum</span>
                </button>
                </button>
                <button onclick="navigateToPage('help-page')" 
                 class="flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700">
                    <i data-lucide="help-circle" class="w-5 h-5"></i>
                    <span>Help Center</span>
                </button>
            </nav>
        </aside>

        <div class="flex-1 flex justify-center">
            <div id="app-container" class="w-full min-h-screen">
                <main id="main-content" class="pb-20 md:pb-0 h-full">
                    
                    <!-- Dashboard Page -->
                    <div id="dashboard-page" class="page active p-4 md:p-6 lg:p-8 h-full">
                         <header class="mb-6">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h1 class="text-3xl font-bold text-gray-900 dark:text-white">कृषि Sahayak</h1>
                                    <p id="welcome-text" class="text-gray-500 dark:text-gray-400">Welcome. Please log in.</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <select id="lang-switcher" class="p-2 rounded-lg border dark:border-gray-600 dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-green-500" onchange="setLanguage(this.value)" aria-label="Select Language">
                                        <option value="en">English</option>
                                        <option value="hi">हिन्दी</option>
                                        <option value="or">ଓଡ଼ିଆ (Odia)</option>
                                        <option value="mr">मराठी (Marathi)</option>
                                        <option value="ta">தமிழ் (Tamil)</option>
                                        <option value="te">తెలుగు (Telugu)</option>
                                        <option value="bn">বাংলা (Bengali)</option>
                                        <option value="gu">ગુજરાતી (Gujarati)</option>
                                        <option value="pa">ਪੰਜਾਬੀ (Punjabi)</option>
                                        <option value="kn">ಕನ್ನಡ (Kannada)</option>
                                    </select>
                                    <button class="dark-mode-toggle p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><i data-lucide="sun" class="w-5 h-5 text-gray-600 dark:text-gray-300 block sun-icon"></i><i data-lucide="moon" class="w-5 h-5 text-gray-600 dark:text-gray-300 hidden moon-icon"></i></button>
                                    <button id="profile-button" class="px-3 py-2 text-xs rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600">Profile</button>
                                    <button id="logout-button" class="hidden px-3 py-2 text-xs rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600">Logout</button>
                                </div>
                            </div>
                        </header>

                        <!-- Main Grid -->
                        <div class="space-y-6">
                            <!-- Top Row Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                                <!-- Weather Overview -->
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-6 shadow-sm">
                                    <h2 class="font-semibold text-lg mb-4">Weather Overview</h2>
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-4">
                                            <i data-lucide="sun" class="w-16 h-16 text-yellow-500"></i>
                                            <div>
                                                <p id="dashboard-temp" class="text-5xl font-bold">--°C</p>
                                                <p id="dashboard-condition" class="text-gray-500 dark:text-gray-400">Loading...</p>
                                            </div>
                                        </div>
                                        <div class="text-sm text-right space-y-1 text-gray-600 dark:text-gray-300">
                                            <p id="dashboard-humidity" class="flex items-center justify-end"><i data-lucide="droplets" class="w-4 h-4 mr-2"></i> --%</p>
                                            <p id="dashboard-wind" class="flex items-center justify-end"><i data-lucide="wind" class="w-4 h-4 mr-2"></i> -- km/h</p>
                                        </div>
                                    </div>
                                    <div class="flex justify-between mt-6 pt-4 border-t dark:border-gray-700 text-center text-sm">
                                        <div class="flex-1"><p class="font-medium text-gray-500">Mon</p><i data-lucide="sun" class="w-6 h-6 mx-auto mt-1 text-yellow-500"></i><p>29°</p></div>
                                        <div class="flex-1"><p class="font-medium text-gray-500">Tue</p><i data-lucide="cloud-sun" class="w-6 h-6 mx-auto mt-1 text-gray-500"></i><p>27°</p></div>
                                        <div class="flex-1"><p class="font-medium text-gray-500">Wed</p><i data-lucide="cloud-rain" class="w-6 h-6 mx-auto mt-1 text-blue-500"></i><p>30°</p></div>
                                        <div class="flex-1"><p class="font-medium text-gray-500">Thu</p><i data-lucide="sun" class="w-6 h-6 mx-auto mt-1 text-yellow-500"></i><p>26°</p></div>
                                        <div class="flex-1"><p class="font-medium text-gray-500">Fri</p><i data-lucide="cloud-sun" class="w-6 h-6 mx-auto mt-1 text-gray-500"></i><p>28°</p></div>
                                    </div>
                                </div>
                                <!-- Real-time Soil Data -->
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-6 shadow-sm">
                                     <div class="flex items-center justify-between mb-1">
                                         <h2 class="font-semibold text-lg">Soil Data</h2>
                                         <div class="flex items-center space-x-2">
                                             <label for="district-select" class="text-xs text-gray-500 dark:text-gray-400">District</label>
                                             <select id="district-select" class="text-sm p-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md"></select>
                                         </div>
                                     </div>
                                     <p class="text-xs text-gray-500 dark:text-gray-400 mb-4"></p>
                                     <div id="soil-data-container" class="space-y-3">
                                        <div id="soil-data-loading" class="text-center text-sm text-gray-500 dark:text-gray-400 pt-8">
                                            <svg class="animate-spin h-6 w-6 text-gray-400 mx-auto mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                            <span>Connecting to sensor...</span>
                                        </div>
                                        <div id="soil-data-content" class="hidden">
                                            <!-- This content will be populated by JavaScript -->
                                        </div>
                                         <div id="soil-data-error" class="hidden text-center text-sm text-red-600 dark:text-red-400 pt-8">
                                            <i data-lucide="wifi-off" class="w-6 h-6 mx-auto mb-2 inline-block"></i> <p>Sensor offline. Check connection.</p>
                                        </div>
                                     </div>
                                </div>
                                <!-- Mandi Prices -->
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-6 shadow-sm">
                                    <div class="flex justify-between items-center mb-4">
                                        <h2 class="font-semibold text-lg">Mandi Prices</h2>
                                        <button onclick="navigateToPage('mandi-page')" class="text-sm font-semibold text-blue-600 dark:text-blue-400 hover:underline">View All</button>
                                    </div>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center">
                                            <div><p class="font-medium">Wheat</p><p class="text-xs text-gray-500">Indore</p></div>
                                            <div class="text-right"><p class="font-semibold">₹2100.00</p><p class="text-xs text-green-600 font-medium">+1.5%</p></div>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <div><p class="font-medium">Soybean</p><p class="text-xs text-gray-500">Nagpur</p></div>
                                            <div class="text-right"><p class="font-semibold">₹4500.00</p><p class="text-xs text-green-600 font-medium">+0.8%</p></div>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <div><p class="font-medium">Cotton</p><p class="text-xs text-gray-500">Aurangabad</p></div>
                                            <div class="text-right"><p class="font-semibold">₹7500.00</p><p class="text-xs text-green-600 font-medium">+2.1%</p></div>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <div><p class="font-medium">Rice (Basmati)</p><p class="text-xs text-gray-500">Karnal</p></div>
                                            <div class="text-right"><p class="font-semibold">₹3500.00</p><p class="text-xs text-green-600 font-medium">+0.5%</p></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Quick Actions -->
                            <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-6 shadow-sm">
                                <h2 class="font-semibold text-lg mb-4">Quick Actions</h2>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <button onclick="navigateToPage('prediction-page')" class="flex flex-col items-center justify-center p-4 bg-green-50 dark:bg-green-900/50 rounded-lg hover:bg-green-100 dark:hover:bg-green-900 transition-colors">
                                        <div class="p-3 bg-green-200 dark:bg-green-800 rounded-full mb-2"><i data-lucide="brain-circuit" class="w-6 h-6 text-green-700 dark:text-green-300"></i></div>
                                        <p class="font-semibold text-sm text-green-800 dark:text-green-200">Predict Yield</p>
                                    </button>
                                    <button onclick="navigateToPage('advisory-page')" class="flex flex-col items-center justify-center p-4 bg-yellow-50 dark:bg-yellow-900/50 rounded-lg hover:bg-yellow-100 dark:hover:bg-yellow-900 transition-colors">
                                        <div class="p-3 bg-yellow-200 dark:bg-yellow-800 rounded-full mb-2"><i data-lucide="lightbulb" class="w-6 h-6 text-yellow-700 dark:text-yellow-300"></i></div>
                                        <p class="font-semibold text-sm text-yellow-800 dark:text-yellow-200">Get Advisory</p>
                                    </button>
                                    <button onclick="navigateToPage('weather-page')" class="flex flex-col items-center justify-center p-4 bg-blue-50 dark:bg-blue-900/50 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900 transition-colors">
                                        <div class="p-3 bg-blue-200 dark:bg-blue-800 rounded-full mb-2"><i data-lucide="cloud-sun" class="w-6 h-6 text-blue-700 dark:text-blue-300"></i></div>
                                        <p class="font-semibold text-sm text-blue-800 dark:text-blue-200">Check Weather</p>
                                    </button>
                                    <button onclick="navigateToPage('community-page')" class="flex flex-col items-center justify-center p-4 bg-indigo-50 dark:bg-indigo-900/50 rounded-lg hover:bg-indigo-100 dark:hover:bg-indigo-900 transition-colors">
                                        <div class="p-3 bg-indigo-200 dark:bg-indigo-800 rounded-full mb-2"><i data-lucide="users" class="w-6 h-6 text-indigo-700 dark:text-indigo-300"></i></div>
                                        <p class="font-semibold text-sm text-indigo-800 dark:text-indigo-200">Join Forum</p>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Prediction Page -->
                    <div id="prediction-page" class="page p-4 lg:p-6">
                        <header class="mb-6 flex items-center justify-between">
                           <div class="flex items-center">
                             <button onclick="navigateToPage('dashboard-page')" class="mr-3 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                             <h1 class="text-2xl font-bold">New Prediction</h1>
                           </div>
                           <button class="dark-mode-toggle p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><i data-lucide="sun" class="w-5 h-5 text-gray-600 dark:text-gray-300 block sun-icon"></i><i data-lucide="moon" class="w-5 h-5 text-gray-600 dark:text-gray-300 hidden moon-icon"></i></button>
                        </header>
                        <div id="prediction-step-1" class="prediction-step active">
                            <h2 class="text-lg font-semibold mb-2">Step 1: Mark Your Field</h2>
                            <p class="text-gray-600 dark:text-gray-400 mb-4">Use your current location or find it on the map.</p>
                            <div id="map" class="w-full h-48 bg-gray-200 dark:bg-gray-700 rounded-lg mb-4"></div>
                            <button id="gps-button" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg flex items-center justify-center space-x-2 hover:bg-blue-700 transition"><i data-lucide="navigation" class="w-5 h-5"></i><span>Use My Current Location</span></button>
                            <div class="mt-4 text-center text-gray-500 dark:text-gray-400">or</div>
                            <input type="text" placeholder="Search for your area..." class="w-full mt-4 p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500">
                            <button onclick="goToPredictionStep(2)" class="w-full mt-6 bg-emerald-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-emerald-700 transition">Confirm Location & Next</button>
                        </div>
                        <div id="prediction-step-2" class="prediction-step">
                            <h2 class="text-lg font-semibold mb-4">Step 2: Enter Crop Details</h2>
                            <form class="space-y-4">
                                <div>
                                    <label for="crop-select" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Crop</label>
                                    <select id="crop-select" class="mt-1 block w-full p-3 border border-gray-300 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"><option>Wheat</option><option>Rice</option><option>Cotton</option><option>Sugarcane</option></select>
                                </div>
                                <div>
                                    <label for="farm-area" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Farm Area (in acres)</label>
                                    <input type="number" id="farm-area" class="mt-1 block w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" placeholder="e.g., 5">
                                </div>
                                <div>
                                    <label for="sowing-date" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Sowing Date</label>
                                    <input type="date" id="sowing-date" class="mt-1 block w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                                </div>
                            </form>
                            <div class="flex space-x-4 mt-6">
                                <button onclick="goToPredictionStep(1)" class="w-full bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 font-semibold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition">Back</button>
                                <button onclick="goToPredictionStep(3); runRuleBasedPrediction();" class="w-full bg-emerald-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-emerald-700 transition">Get Prediction</button>
                            </div>
                        </div>
                        <div id="prediction-step-3" class="prediction-step text-center">
                            <div id="loading-spinner" class="flex flex-col items-center justify-center h-64"><svg class="animate-spin -ml-1 mr-3 h-10 w-10 text-emerald-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><p class="mt-4 text-lg font-semibold text-gray-700 dark:text-gray-300">Analyzing Data...</p><p class="text-sm text-gray-500 dark:text-gray-400">Our AI is crunching the numbers.</p></div>
                            <div id="results-content" class="hidden">
                                <h2 class="text-lg font-semibold mb-2">Prediction Results</h2>
                                <div class="bg-emerald-50 dark:bg-emerald-900/50 border-2 border-emerald-500 text-emerald-900 dark:text-emerald-300 p-6 rounded-xl my-4">
                                    <p class="text-sm">Predicted Yield</p>
                                    <p class="text-5xl font-bold">45.5</p>
                                    <p class="text-lg">Quintals / Acre</p>
                                    <p class="text-xs mt-2 opacity-70">Confidence: 88%</p>
                                </div>
                                <div><canvas id="yieldChart"></canvas></div>
                                <div class="text-left mt-6">
                                    <h3 class="font-semibold mb-2">Key Factors & Recommendations</h3>
                                    <div class="space-y-2">
                                        <p class="text-green-700 dark:text-green-400 text-sm flex items-start"><i data-lucide="plus-circle" class="w-4 h-4 mr-2 mt-0.5 flex-shrink-0"></i> <span>Expected timely monsoon is a positive factor.</span></p>
                                        <p class="text-red-700 dark:text-red-400 text-sm flex items-start"><i data-lucide="minus-circle" class="w-4 h-4 mr-2 mt-0.5 flex-shrink-0"></i> <span>High temperatures in October might affect growth.</span></p>
                                        <p class="text-blue-700 dark:text-blue-400 text-sm flex items-start"><i data-lucide="info" class="w-4 h-4 mr-2 mt-0.5 flex-shrink-0"></i> <span>Recommendation: Soil nitrogen levels seem low. Consider urea application.</span></p>
                                    </div>
                                </div>
                                <div class="mt-8 p-4 border rounded bg-white dark:bg-gray-800">
                                    <h3 class="font-semibold mb-2">Rule-Based Prediction</h3>
                                    <p><b>Predicted Yield:</b> <span id="predicted-yield"></span></p>
                                    <p><b>Irrigation Recommendation:</b> <span id="irrigation-recommendation"></span></p>
                                    <p><b>Crop Recommendation:</b> <span id="crop-recommendation"></span></p>
                                    <p><b>Explanation:</b> <span id="prediction-explanation"></span></p>
                                </div>
                                <button onclick="goToPredictionStep(1)" class="w-full mt-6 bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition">Start a New Prediction</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Weather Page -->
                    <div id="weather-page" class="page p-4 md:p-6 lg:p-8 h-full">
                         <header class="mb-6 flex justify-between items-center">
                           <div>
                               <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Weather Forecast</h1>
                               <p id="weather-page-location" class="text-gray-500 dark:text-gray-400">Detailed weather information for your location.</p>
                           </div>
                           <button class="dark-mode-toggle p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><i data-lucide="sun" class="w-5 h-5 text-gray-600 dark:text-gray-300 block sun-icon"></i><i data-lucide="moon" class="w-5 h-5 text-gray-600 dark:text-gray-300 hidden moon-icon"></i></button>
                        </header>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="lg:col-span-1 space-y-6">
                                <div class="bg-gradient-to-br from-blue-500 to-indigo-600 text-white p-6 rounded-xl shadow-lg text-center"><i data-lucide="cloud-sun" class="w-20 h-20 mx-auto opacity-90"></i><h2 id="weather-page-temp" class="text-5xl font-bold mt-2">--°C</h2><p id="weather-page-condition" class="font-semibold text-lg">Loading...</p><p id="weather-page-city" class="text-sm">Your Location</p></div>
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <h3 class="font-semibold mb-3">Agricultural Advisory</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">High humidity expected for the next 3 days. Monitor your crop for fungal diseases. Consider prophylactic spraying.</p>
                                </div>
                            </div>
                            <div class="lg:col-span-2 space-y-6">
                                <div>
                                    <h3 class="font-bold mb-3 text-xl">Hourly Forecast</h3>
                                    <div class="flex space-x-4 overflow-x-auto pb-3">
                                         <div class="text-center bg-gray-100 dark:bg-gray-800/50 p-3 rounded-lg flex-shrink-0 min-w-[70px]"><p class="text-sm">Now</p><i data-lucide="cloud-sun" class="w-8 h-8 mx-auto my-1 text-gray-700 dark:text-gray-300"></i><p class="font-semibold">32°</p></div>
                                         <div class="text-center bg-gray-100 dark:bg-gray-800/50 p-3 rounded-lg flex-shrink-0 min-w-[70px]"><p class="text-sm">3 PM</p><i data-lucide="sun" class="w-8 h-8 mx-auto my-1 text-yellow-500"></i><p class="font-semibold">33°</p></div>
                                         <div class="text-center bg-gray-100 dark:bg-gray-800/50 p-3 rounded-lg flex-shrink-0 min-w-[70px]"><p class="text-sm">4 PM</p><i data-lucide="sun" class="w-8 h-8 mx-auto my-1 text-yellow-500"></i><p class="font-semibold">32°</p></div>
                                         <div class="text-center bg-gray-100 dark:bg-gray-800/50 p-3 rounded-lg flex-shrink-0 min-w-[70px]"><p class="text-sm">5 PM</p><i data-lucide="cloudy" class="w-8 h-8 mx-auto my-1 text-gray-500"></i><p class="font-semibold">31°</p></div>
                                         <div class="text-center bg-gray-100 dark:bg-gray-800/50 p-3 rounded-lg flex-shrink-0 min-w-[70px]"><p class="text-sm">6 PM</p><i data-lucide="cloudy" class="w-8 h-8 mx-auto my-1 text-gray-500"></i><p class="font-semibold">30°</p></div>
                                    </div>
                                </div>
                                <div>
                                    <h3 class="font-bold mb-3 text-xl">3-Day Forecast</h3>
                                    <div class="space-y-2">
                                         <div class="flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg"><p class="font-semibold w-1/4">Today</p><i data-lucide="cloud-sun" class="w-6 h-6 text-gray-600 dark:text-gray-300"></i><p class="w-1/4 text-right">H: 34° L: 25°</p></div>
                                         <div class="flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg"><p class="font-semibold w-1/4">Mon</p><i data-lucide="cloud-rain" class="w-6 h-6 text-blue-500 dark:text-blue-400"></i><p class="w-1/4 text-right">H: 31° L: 24°</p></div>
                                         <div class="flex items-center justify-between bg-gray-50 dark:bg-gray-800/50 p-3 rounded-lg"><p class="font-semibold w-1/4">Tue</p><i data-lucide="cloud-lightning" class="w-6 h-6 text-yellow-500 dark:text-yellow-400"></i><p class="w-1/4 text-right">H: 30° L: 23°</p></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mandi Prices Page -->
                     <div id="mandi-page" class="page p-4 md:p-6 lg:p-8 h-full">
   <h1 class="text-2xl font-bold mb-4">Mandi Prices</h1>

   <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm mb-6">
     <div class="grid grid-cols-1 md:grid-cols-6 gap-3">
       <select id="mandi-crop" class="p-2 border dark:border-gray-700 dark:bg-gray-800 dark:text-white rounded">
         <option value="">Select Crop</option>
       </select>
       <select id="mandi-state" class="p-2 border dark:border-gray-700 dark:bg-gray-800 dark:text-white rounded">
         <option value="">Select State</option>
       </select>
       <select id="mandi-district" class="p-2 border dark:border-gray-700 dark:bg-gray-800 dark:text-white rounded">
         <option value="">Select District</option>
       </select>
       <select id="mandi-sort" class="p-2 border dark:border-gray-700 dark:bg-gray-800 dark:text-white rounded">
         <option value="modal_desc">Sort: Modal Price ↓</option>
         <option value="modal_asc">Sort: Modal Price ↑</option>
         <option value="max_desc">Sort: Max Price ↓</option>
         <option value="min_asc">Sort: Min Price ↑</option>
       </select>
       <div class="flex gap-2">
         <button id="applyFilter" class="bg-green-600 hover:bg-green-700 text-white px-3 rounded w-full">Apply</button>
         <button id="clearFilter" class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100 px-3 rounded w-full">Clear</button>
       </div>
     </div>
     <div class="mt-3 flex items-center justify-between text-sm text-gray-600 dark:text-gray-300">
       <div id="mandi-active-tags" class="flex flex-wrap gap-2"></div>
       <div id="mandi-count" class="font-medium"></div>
     </div>
   </div>

   <div id="mandi-stats" class="grid grid-cols-1 sm:grid-cols-3 gap-3 mb-4">
     <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-3 text-center">
       <p class="text-xs text-gray-600 dark:text-gray-300">Average Min</p>
       <p id="stat-avg-min" class="text-lg font-semibold">—</p>
     </div>
     <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-3 text-center">
       <p class="text-xs text-gray-600 dark:text-gray-300">Average Modal</p>
       <p id="stat-avg-modal" class="text-lg font-semibold">—</p>
     </div>
     <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-3 text-center">
       <p class="text-xs text-gray-600 dark:text-gray-300">Average Max</p>
       <p id="stat-avg-max" class="text-lg font-semibold">—</p>
     </div>
   </div>

   <div id="mandi-chart" class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm mb-6">
     <div class="flex items-center justify-between mb-3">
       <h3 class="font-semibold">Top Markets by Modal Price</h3>
       <span id="chart-note" class="text-xs text-gray-500">Up to 5 entries</span>
     </div>
     <div id="mandi-chart-bars" class="space-y-2"></div>
   </div>

   <div id="mandi-results" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
   <div class="flex justify-center mt-4">
     <button id="mandi-load-more" class="hidden px-4 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100">Load more</button>
   </div>
 </div>
                            
                           
                    <!-- Community Forum Page -->
                    <div id="community-page" class="page p-4 md:p-6 lg:p-8 h-full">
                         <header class="mb-6 flex justify-between items-center">
                           <div>
                               <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Community Forum</h1>
                               <p class="text-gray-500 dark:text-gray-400">Ask questions and share knowledge with fellow farmers.</p>
                           </div>
                           <button class="dark-mode-toggle p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><i data-lucide="sun" class="w-5 h-5 text-gray-600 dark:text-gray-300 block sun-icon"></i><i data-lucide="moon" class="w-5 h-5 text-gray-600 dark:text-gray-300 hidden moon-icon"></i></button>
                        </header>
                        <!-- Create Post Modal -->
                        <div id="new-post-modal" class="hidden fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4">
                            <div class="bg-white dark:bg-gray-800 w-full max-w-lg rounded-xl shadow-xl p-5">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="text-lg font-semibold">Create New Post</h3>
                                    <button id="close-new-post" class="p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"><i data-lucide="x" class="w-5 h-5"></i></button>
                                </div>
                                <div class="space-y-3">
                                    <input id="post-author" type="text" placeholder="Your name" class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg">
                                    <input id="post-title" type="text" placeholder="Title" class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg">
                                    <textarea id="post-content" rows="4" placeholder="Write your question or share your experience..." class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg"></textarea>
                                </div>
                                <div class="flex justify-end space-x-2 mt-4">
                                    <button id="cancel-new-post" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700">Cancel</button>
                                    <button id="save-new-post" class="px-4 py-2 rounded-lg bg-emerald-600 text-white">Post</button>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="lg:col-span-2 space-y-4">
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                        <input id="forum-search" type="text" placeholder="Search posts (title, content, author)" class="p-2 border dark:border-gray-700 dark:bg-gray-800 dark:text-white rounded">
                                        <select id="forum-sort" class="p-2 border dark:border-gray-700 dark:bg-gray-800 dark:text-white rounded">
                                            <option value="recent">Sort: Recent</option>
                                            <option value="likes">Sort: Most Liked</option>
                                            <option value="replies">Sort: Most Replies</option>
                                        </select>
                                        <button id="forum-new-post" class="bg-emerald-600 text-white font-semibold py-2 px-3 rounded hover:bg-emerald-700 flex items-center justify-center space-x-2"><i data-lucide="plus" class="w-4 h-4"></i><span>New Post</span></button>
                                    </div>
                                </div>
                                <div id="forum-posts" class="space-y-4"></div>
                                <div class="flex justify-center">
                                    <button id="forum-load-more" class="hidden px-4 py-2 rounded bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100">Load more</button>
                                </div>
                            </div>
                            <div class="lg:col-span-1 space-y-6">
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <button id="create-post-btn" class="w-full bg-emerald-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-emerald-700 flex items-center justify-center space-x-2"><i data-lucide="plus" class="w-5 h-5"></i><span>Create New Post</span></button>
                                </div>
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <h3 class="font-semibold mb-3">Categories</h3>
                                    <ul class="space-y-2 text-sm">
                                        <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Pest Management</a></li>
                                        <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Crop Diseases</a></li>
                                        <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Organic Farming</a></li>
                                        <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Government Schemes</a></li>
                                    </ul>
                                </div>
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <h3 class="font-semibold mb-3">Trending Topics</h3>
                                    <ul id="forum-trending" class="space-y-2 text-sm"></ul>
                                </div>
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <h3 class="font-semibold mb-3">Quick Poll</h3>
                                    <p class="text-sm mb-3">What content would you like to see more?</p>
                                    <div id="forum-poll" class="space-y-2"></div>
                                </div>
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <h3 class="font-semibold mb-3">Top Contributors</h3>
                                    <div id="forum-top" class="space-y-2"></div>
                                </div>
                                <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
                                    <h3 class="font-semibold mb-3">Recent Activity</h3>
                                    <ul id="forum-activity" class="space-y-2 text-sm"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                              <!-- Help Center Page -->
<div id="help-page" class="page p-4 md:p-6 lg:p-8 h-full">
  <header class="mb-6 flex flex-col gap-4 md:flex-row md:justify-between md:items-center">
    <div>
      <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Help Center</h1>
      <p class="text-gray-500 dark:text-gray-400">Find answers or reach out for assistance</p>
    </div>
    <div class="flex items-center gap-3">
      <button class="dark-mode-toggle p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">
        <i data-lucide="sun" class="w-5 h-5 text-gray-600 dark:text-gray-300 block sun-icon"></i>
        <i data-lucide="moon" class="w-5 h-5 text-gray-600 dark:text-gray-300 hidden moon-icon"></i>
      </button>
    </div>
  </header>

  <!-- Tabs -->
  <div class="flex space-x-4 mb-6 border-b dark:border-gray-700">
    <button onclick="showHelpTab('faq')" id="faq-tab"
      class="px-4 py-2 font-medium border-b-2 border-green-600 text-green-600">FAQs</button>
    <button onclick="showHelpTab('contact')" id="contact-tab"
      class="px-4 py-2 font-medium text-gray-600 dark:text-gray-300 hover:text-green-600">Contact</button>
  </div>

  <!-- FAQs Section -->
  <div id="faq-section" class="space-y-4">
    <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
      <h3 class="font-semibold">How can I check crop prices?</h3>
      <p class="text-sm text-gray-600 dark:text-gray-300">Go to the "Mandi Prices" section from the sidebar. You can view daily updated prices.</p>
    </div>
    <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
      <h3 class="font-semibold">How do I get weather updates?</h3>
      <p class="text-sm text-gray-600 dark:text-gray-300">Open the "Weather" page in the app. It shows real-time forecasts for your location.</p>
    </div>
    <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-4 shadow-sm">
      <h3 class="font-semibold">Who can I contact for technical help?</h3>
      <p class="text-sm text-gray-600 dark:text-gray-300">Use the Contact tab in this Help Center to reach our support team directly.</p>
    </div>
  </div>

  <!-- Contact Section (hidden by default) -->
  <div id="contact-section" class="hidden">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Info -->
      <div class="lg:col-span-1 space-y-6">
        <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-5 shadow-sm">
          <h3 class="font-semibold flex items-center space-x-2">
            <i data-lucide="phone" class="w-5 h-5 text-green-600"></i><span>24x7 Helpline</span>
          </h3>
          <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">+91-98765-43210</p>
        </div>
        <div class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-5 shadow-sm">
          <h3 class="font-semibold flex items-center space-x-2">
            <i data-lucide="mail" class="w-5 h-5 text-green-600"></i><span>Email Support</span>
          </h3>
          <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">support@krishsahayak.example</p>
        </div>
      </div>

      <!-- Form -->
      <div class="lg:col-span-2 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-6 shadow-md">
        <h3 class="text-xl font-semibold mb-4">Submit Your Query / Suggestion</h3>
        <form id="contact-form" class="space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" placeholder="Your Name" class="p-3 border rounded-lg focus:ring-2 focus:ring-green-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white" required>
            <input type="email" placeholder="Your Email (optional)" class="p-3 border rounded-lg focus:ring-2 focus:ring-green-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white">
          </div>
          <select class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white" required>
            <option value="">Select Type</option>
            <option value="feedback">Feedback</option>
            <option value="query">General Query</option>
            <option value="suggestion">Suggestion</option>
            <option value="complaint">Complaint</option>
          </select>
          <textarea rows="5" placeholder="Write your message..." class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white" required></textarea>
          <button type="submit" class="w-full py-3 rounded-lg bg-green-600 text-white font-medium hover:bg-green-700 transition">
            Submit Response
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  // Switch between FAQ and Contact
  function showHelpTab(tab) {
    document.getElementById('faq-section').classList.add('hidden');
    document.getElementById('contact-section').classList.add('hidden');
    document.getElementById('faq-tab').classList.remove('border-green-600','text-green-600');
    document.getElementById('contact-tab').classList.remove('border-green-600','text-green-600');

    if (tab === 'faq') {
      document.getElementById('faq-section').classList.remove('hidden');
      document.getElementById('faq-tab').classList.add('border-green-600','text-green-600');
    } else {
      document.getElementById('contact-section').classList.remove('hidden');
      document.getElementById('contact-tab').classList.add('border-green-600','text-green-600');
    }
  }

  // Form handler
  document.getElementById('contact-form').addEventListener('submit', e => {
    e.preventDefault();
    alert("✅ Thank you! Your response has been recorded.");
  });
</script>
                <!-- Smart Advisory Page -->
                     <div id="advisory-page" class="page p-4 md:p-6 lg:p-8 h-full">
                         <header class="mb-6 flex justify-between items-center">
                           <div>
                               <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Smart Advisory</h1>
                               <p class="text-gray-500 dark:text-gray-400">AI-powered recommendations for your farm.</p>
                           </div>
                            <button class="dark-mode-toggle p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700"><i data-lucide="sun" class="w-5 h-5 text-gray-600 dark:text-gray-300 block sun-icon"></i><i data-lucide="moon" class="w-5 h-5 text-gray-600 dark:text-gray-300 hidden moon-icon"></i></button>
                        </header>
                        <div id="advisory-content" class="bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-xl p-6 shadow-sm">
                            <div class="flex items-start justify-between">
                                <div class="flex items-start space-x-3">
                                    <div>
                                        <div class="p-2 bg-indigo-200 dark:bg-indigo-800 rounded-full flex items-center justify-center">
                                            <i data-lucide="info" class="w-5 h-5 text-indigo-700 dark:text-indigo-300"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <h3 class="font-semibold text-lg text-indigo-900 dark:text-indigo-200 mb-1">Today's Advisory</h3>
                                        <p id="advisory-message" class="text-sm text-indigo-800 dark:text-indigo-300">Loading analysis...</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span id="advisory-status" class="px-2 py-1 text-[10px] rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200">Idle</span>
                                    <button id="regenerate-advisory" class="px-3 py-2 text-xs rounded-md bg-indigo-600 text-white hover:bg-indigo-700">Regenerate</button>
                                </div>
                            </div>
                            <div id="advisory-metrics" class="mt-4 flex flex-wrap gap-2"></div>
                            <div id="advisory-visual" class="mt-4 space-y-2"></div>
                        </div>
                    </div>
                </main>

                <!-- Mobile Bottom Nav -->
                <nav class="md:hidden fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-lg bg-white dark:bg-gray-800 border-t dark:border-gray-700 border-gray-200 flex justify-around py-2">
                    <button onclick="navigateToPage('dashboard-page')" class="nav-item nav-item-mobile flex-1 flex flex-col items-center justify-center text-gray-600 dark:text-gray-400 hover:text-blue-600 transition-colors"><i data-lucide="layout-dashboard" class="w-6 h-6 mb-1"></i><p class="text-xs font-medium">Dashboard</p></button>
                    <button onclick="navigateToPage('weather-page')" class="nav-item nav-item-mobile flex-1 flex flex-col items-center justify-center text-gray-600 dark:text-gray-400 hover:text-blue-600 transition-colors"><i data-lucide="cloud-sun" class="w-6 h-6 mb-1"></i><p class="text-xs font-medium">Weather</p></button>
                    <button onclick="navigateToPage('prediction-page')" class="nav-item nav-item-mobile flex-1 flex flex-col items-center justify-center text-gray-600 dark:text-gray-400 hover:text-blue-600 transition-colors transform -translate-y-3"><div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center text-white shadow-lg border-4 border-white dark:border-gray-800"><i data-lucide="brain-circuit" class="w-8 h-8"></i></div></button>
                    <button onclick="navigateToPage('mandi-page')" class="nav-item nav-item-mobile flex-1 flex flex-col items-center justify-center text-gray-600 dark:text-gray-400 hover:text-blue-600 transition-colors"><i data-lucide="bar-chart-3" class="w-6 h-6 mb-1"></i><p class="text-xs font-medium">Mandi</p></button>
                    <button onclick="navigateToPage('community-page')" class="nav-item nav-item-mobile flex-1 flex flex-col items-center justify-center text-gray-600 dark:text-gray-400 hover:text-blue-600 transition-colors"><i data-lucide="users" class="w-6 h-6 mb-1"></i><p class="text-xs font-medium">Community</p></button>
                </nav>
            </div>
        </div>
    </div>

    <!-- FIX: Consolidated all scripts into one block to prevent conflicts and race conditions -->
    
    <script src="https://unpkg.com/i18next@23.11.2/dist/umd/i18next.min.js"></script>
    <script src="mandi.js"></script>
     <script src="script.js"></script>

</body>
</html>

